<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>成績查詢與管理系統 - 完整版</title>
    <link rel="stylesheet" href="style.css"> 
</head>
<body>
    <div class="container">

        <div id="login-container">
            <h2>成績查詢登入</h2>
            <form id="login-form">
                <label for="school">學校名稱：</label>
                <input type="text" id="school" value="永靖高工" required>
                
                <label for="class">班級：</label>
                <input type="text" id="class" value="資訊二" required>
                
                <label for="account">學號：</label>
                <input type="text" id="account" placeholder="請輸入學號" required>
                
                <label for="password">密碼 (Qimei@admin)：</label>
                <input type="password" id="password" placeholder="輸入查詢密碼或學號密碼" required>
                
                <p id="login-error" class="error hidden">帳號、班級或密碼錯誤。</p>
                <button type="submit" class="primary-btn">登入查詢</button>
            </form>
            <button type="button" id="teacher-login-btn" onclick="showAdminLogin()">我是教師，點擊登入管理介面</button>
        </div>

        <div id="admin-login-container" class="hidden">
            <h2>教師管理員登入</h2>
            <form id="admin-login-form">
                <label for="admin-password">管理密碼 (Teacher@admin)：</label>
                <input type="password" id="admin-password" required>
                <p id="admin-login-error" class="error hidden">管理密碼錯誤。</p>
                <button type="submit" class="primary-btn" style="max-width: 100%;">登入管理</button>
            </form>
            <button type="button" class="secondary-btn" onclick="showStudentLogin()">返回學生登入</button>
        </div>

        <div id="result-container" class="hidden">
            <h2>查詢結果</h2>
            
            <div class="result-card">
                <h3>學生基本資料</h3>
                <div id="basic-info">
                    <p>學號：<span id="result-account"></span></p>
                    <p>姓名：<span id="result-name"></span></p>
                    <p>學校：<span id="result-school"></span></p>
                    <p>班級：<span id="result-class"></span></p>
                    <p>電子郵件：<span id="result-email"></span></p>
                </div>
            </div>

            <div class="result-card">
                <h3>學期成績與活動完成度</h3>
                <table id="tasks-table-student">
                    <thead>
                        <tr>
                            <th>項目</th>
                            <th>狀態</th>
                            <th>留言 / 操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>

            <button type="button" class="logout-btn" onclick="logout()">登出查詢</button>
        </div>

        <div id="admin-container" class="hidden">
            <h2>學生資料管理介面</h2>

            <div id="add-edit-student-card" class="admin-card">
                <h3 id="student-form-title">新增 / 編輯學生</h3>
                <form id="student-form">
                    <div class="form-group-inline">
                        <div style="flex: 1 1 45%;">
                            <label for="admin-account">帳號 (唯一)：</label>
                            <input type="text" id="admin-account" placeholder="輸入學號" required>
                        </div>
                        <div style="flex: 1 1 45%;">
                            <label for="admin-name">姓名 (遮擋前)：</label>
                            <input type="text" id="admin-name" placeholder="輸入學生全名" required>
                        </div>
                    </div>

                    <div class="form-group-inline">
                        <div style="flex: 1 1 45%;">
                            <label for="admin-school">學校名稱：</label>
                            <input type="text" id="admin-school" value="永靖高工" required>
                        </div>
                        <div style="flex: 1 1 45%;">
                            <label for="admin-class">班級：</label>
                            <input type="text" id="admin-class" value="資訊二" required>
                        </div>
                    </div>

                    <label for="admin-email">電子郵件：</label>
                    <input type="text" id="admin-email" placeholder="電子郵件（用於遮擋顯示）" required>
                    
                    <h4 style="margin-top: 30px;">活動/成績項目管理</h4>
                    <table id="tasks-table-admin">
                        <thead>
                            <tr>
                                <th>項目名稱</th>
                                <th>狀態</th>
                                <th>教師留言狀態</th>
                                <th>留言記錄</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            </tbody>
                    </table>
                    
                    <button type="button" id="add-task-btn" onclick="addTaskRow()">+ 新增項目</button>
                    
                    <div class="form-actions">
                        <button type="submit" id="submit-student-btn" class="primary-btn">更新學生資料</button>
                        <button type="button" id="switch-to-new-student-btn" onclick="switchToNewStudentMode()" class="primary-btn">新增學生 (切換)</button>
                        <button type="button" onclick="resetForm()" class="secondary-btn">重設/取消編輯</button>
                    </div>
                </form>
            </div>

            <div class="admin-card" style="margin-top: 30px;">
                <h3 id="student-list-title">所有學生列表</h3>
                <table id="student-list-table">
                    <thead>
                        <tr>
                            <th>帳號</th>
                            <th>姓名</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        </tbody>
                </table>
            </div>

            <button type="button" class="logout-btn" onclick="adminLogout()">登出教師介面</button>
        </div>
    </div>

    <div id="comment-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h3 id="modal-title">項目留言</h3>
            
            <div id="comment-history" style="max-height: 300px; overflow-y: auto; padding-right: 15px;">
                </div>

            <div id="new-comment-area" style="margin-top: 20px;">
                <h4 style="margin-bottom: 10px;">新增留言</h4>
                <textarea id="comment-input" placeholder="輸入您的留言..." rows="4"></textarea>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <button type="button" id="submit-comment-btn" class="primary-btn">提交留言</button>
                </div>
            </div>
            
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
